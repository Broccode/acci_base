{{ define "slack.title" }}
[{{ .Status | toUpper }}{{ if eq .Status "firing" }}:{{ .Alerts.Firing | len }}{{ end }}] {{ .CommonLabels.alertname }}
{{ end }}

{{ define "slack.color" }}
{{- if eq .Status "firing" -}}
  {{- if eq .CommonLabels.severity "critical" -}}
    danger
  {{- else if eq .CommonLabels.severity "warning" -}}
    warning
  {{- else -}}
    #439FE0
  {{- end -}}
{{- else -}}
  good
{{- end -}}
{{ end }}

{{ define "slack.text" }}
{{ if gt (len .Alerts.Firing) 0 }}
*ðŸš¨ Alerts Firing:*
{{ range .Alerts.Firing }}
â€¢ *Alert:* {{ .Labels.alertname }}{{ if .Labels.severity }} - `{{ .Labels.severity }}`{{ end }}
*Description:* {{ .Annotations.description }}
*Started:* <!date^{{ .StartsAt.Unix }}^{date_num} {time}|{{ .StartsAt }}> ({{ .StartsAt.Unix | since }})
*Details:*
{{ range .Labels.SortedPairs }} - {{ .Name }}: `{{ .Value }}`
{{ end }}
{{ if .Annotations.runbook_url }}*ðŸ“š Runbook:* {{ .Annotations.runbook_url }}{{ end }}
{{ if .Annotations.dashboard_url }}*ðŸ“Š Dashboard:* {{ .Annotations.dashboard_url }}{{ end }}
{{ if .Annotations.metrics }}*ðŸ“ˆ Metrics:*
{{ .Annotations.metrics }}{{ end }}
{{ end }}
{{ end }}

{{ if gt (len .Alerts.Resolved) 0 }}
*âœ… Alerts Resolved:*
{{ range .Alerts.Resolved }}
â€¢ *Alert:* {{ .Labels.alertname }}{{ if .Labels.severity }} - `{{ .Labels.severity }}`{{ end }}
*Description:* {{ .Annotations.description }}
*Resolved:* <!date^{{ .EndsAt.Unix }}^{date_num} {time}|{{ .EndsAt }}> (Duration: {{ .StartsAt.Unix | since }})
{{ end }}
{{ end }}

*Affected Services:* {{ .CommonLabels.service }}
*Cluster:* {{ .CommonLabels.cluster }}
*Environment:* {{ .CommonLabels.environment }}

{{ if .CommonAnnotations.playbook }}*ðŸ”§ Playbook:* {{ .CommonAnnotations.playbook }}{{ end }}
{{ if .CommonAnnotations.impact }}*ðŸ’¥ Impact:* {{ .CommonAnnotations.impact }}{{ end }}
{{ end }} 